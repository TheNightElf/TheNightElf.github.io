---
title: 关于数据结构的设计
date: 2018-3-4 15:08:16
tags:
---

传统的数据设计中，大多都是以一种 `JSON` `的数据格式来设计的。我并不否认，JSON` 是一种非常直观、方便的储存的方式，毕竟它的出现就是为了替代啰嗦的 `XML` 格式的。不过当 `ES6` 来临之后，你会发现 `JSON` 格式也会有些啰嗦。
<!-- more -->

### 使用JSON来储存数据

这里我们直接使用 **文章** 来举例。如果按照 `JSON` 来设计，应该是下面这个样子的：

```js
const articles = [{
    id: ,
    read: ,
    createdTime: ,
    modifiedTime: ,
    author: ,
    // ...
}]
```

这是一个非常典型的 `JSON` 数据结构。它非常直观的表示了一个文章的集合。
下面我们看下如何对它进行 `增删改查` 的操作。

```js
// add

    // push 并不是一个很好的追加方式，没有更改指针
articles.push({
    id: ,
    read: ,
    createdTime: ,
    modifiedTime: ,
    author: ,
    // ...
});

    // concat 是一种推荐的方式
articles = articles.concat([{
    id: ,
    read: ,
    createdTime: ,
    modifiedTime: ,
    author: ,
    // ...
}]);


// delete
articles = articles.filter(v => v.id !== xxx.id);

// update
articles = articles.map(
    v => (v.id === xxx.id ? Object.assign(v, {xxx: 'xxx'}) : v)
);

// get
let article;
articles.forEach(v => v.id === xxx.id ? article = v : null)
```

发现了吗？不管你要进行哪种操作，都需要遍历一遍才行。
如果是两个组数据相互关联的话，就需要遍历就需要嵌套了，估计每一个程序员都不想遇到这种情况。
下面我们来看一种 `Object` 的储存形式。

### 使用 `Object` 来储存数据

还是用文章来举例：

```js
const articles = {
    [id]: {
        id: ,
        read: ,
        createdTime: ,
        modifiedTime: ,
        author: ,
        // ...
    }
}
```

下面我们看下如何对它进行 `增删改查` 的操作。

```js
// add

articles = Object.assign({}, articles, {
    [id]: {
        id: ,
        read: ,
        createdTime: ,
        modifiedTime: ,
        author: ,
        // ...
    }
})


// delete

delete articles[id]

// update

articles = Object.assign(
    {},
    {articles},
    {
        [id]: {
            ...articles[id],
            xxx: 'xx'
        }
    }
)

// get

articles[id]
```

`what ?` 对，你没有看错，一次遍历都没有！一次遍历都没有！一次遍历都没有！
而且我们在 `改删` 时候的操作是不是非常的简洁？关于更多类似于这种数据结构的设计你可以[点击这里](https://github.com/paularmstrong/normalizr)。

### 为什么现在才流行起来？

并不是说以前的人太笨了，而是在 `ES6` 普及之后，这种数据格式才真正开始兴起。

```js
// ES6 常用 Object 操作

// 1. 返回对象的键的数组
Object.keys(); 

// 2. 返回对象的值的数据
Object.values();

// 3. 合并多个对象并返回
Object.assign();

// 4. 返回对象的键值对的二维数组
Object.entries();


// ES6 常用 Array 操作

// 1. 目标值是否是一个数组
Array.isArray();

// 2. 过滤数组
Array.filter();

// 3. 遍历数组
Array.map();

// 4. 缩减数组
Array.reduce();

// 5. 缩减数组，从右到左。
Array.reduceRight();

// 6. 遍历数组，找到符合的元素并返回
Array.find();

// 7. 遍历数组，找到符合的元素并返回其索引
Array.findIndex();

// 8. 排序数组
Array.sort();

// 9. 数组是否包含某个元素
Array.includes();
```

上面这些是工作中可能会频繁用到的，关于数组或对象的更多更多用法可以自行参阅[MDN-Array](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array)和[MDN-Object](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object)。