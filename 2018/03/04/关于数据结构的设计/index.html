<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 关于数据结构的设计 · 冷暖我自知</title><meta name="description" content="关于数据结构的设计 - 冷暖我自知"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/blog/favicon.ico"><link rel="stylesheet" href="/blog/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://github.com/TheNightElf/atom.xml" title="冷暖我自知"></head><body><div class="wrap"><header><ul class="nav nav-list"><li class="nav-list-item"><a href="/blog/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/blog/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/TheNightElf" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">关于数据结构的设计</h1><div class="post-info">2018年3月4日</div><div class="post-content"><p>传统的数据设计中，大多都是以一种 <code>JSON</code> <code>的数据格式来设计的。我并不否认，JSON</code> 是一种非常直观、方便的储存的方式，毕竟它的出现就是为了替代啰嗦的 <code>XML</code> 格式的。不过当 <code>ES6</code> 来临之后，你会发现 <code>JSON</code> 格式也会有些啰嗦。<br><a id="more"></a></p>
<h3 id="使用JSON来储存数据"><a href="#使用JSON来储存数据" class="headerlink" title="使用JSON来储存数据"></a>使用JSON来储存数据</h3><p>这里我们直接使用 <strong>文章</strong> 来举例。如果按照 <code>JSON</code> 来设计，应该是下面这个样子的：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> articles = [&#123;</span><br><span class="line">    id: ,</span><br><span class="line">    read: ,</span><br><span class="line">    createdTime: ,</span><br><span class="line">    modifiedTime: ,</span><br><span class="line">    author: ,</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;]</span><br></pre></td></tr></table></figure>
<p>这是一个非常典型的 <code>JSON</code> 数据结构。它非常直观的表示了一个文章的集合。<br>下面我们看下如何对它进行 <code>增删改查</code> 的操作。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// add</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// push 并不是一个很好的追加方式，没有更改指针</span></span><br><span class="line">articles.push(&#123;</span><br><span class="line">    id: ,</span><br><span class="line">    read: ,</span><br><span class="line">    createdTime: ,</span><br><span class="line">    modifiedTime: ,</span><br><span class="line">    author: ,</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// concat 是一种推荐的方式</span></span><br><span class="line">articles = articles.concat([&#123;</span><br><span class="line">    id: ,</span><br><span class="line">    read: ,</span><br><span class="line">    createdTime: ,</span><br><span class="line">    modifiedTime: ,</span><br><span class="line">    author: ,</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// delete</span></span><br><span class="line">articles = articles.filter(<span class="function"><span class="params">v</span> =&gt;</span> v.id !== xxx.id);</span><br><span class="line"></span><br><span class="line"><span class="comment">// update</span></span><br><span class="line">articles = articles.map(</span><br><span class="line">    v =&gt; (v.id === xxx.id ? <span class="built_in">Object</span>.assign(v, &#123;<span class="attr">xxx</span>: <span class="string">'xxx'</span>&#125;) : v)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// get</span></span><br><span class="line"><span class="keyword">let</span> article;</span><br><span class="line">articles.forEach(<span class="function"><span class="params">v</span> =&gt;</span> v.id === xxx.id ? article = v : <span class="literal">null</span>)</span><br></pre></td></tr></table></figure>
<p>发现了吗？不管你要进行哪种操作，都需要遍历一遍才行。<br>如果是两个组数据相互关联的话，就需要遍历就需要嵌套了，估计每一个程序员都不想遇到这种情况。<br>下面我们来看一种 <code>Object</code> 的储存形式。</p>
<h3 id="使用-Object-来储存数据"><a href="#使用-Object-来储存数据" class="headerlink" title="使用 Object 来储存数据"></a>使用 <code>Object</code> 来储存数据</h3><p>还是用文章来举例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> articles = &#123;</span><br><span class="line">    [id]: &#123;</span><br><span class="line">        id: ,</span><br><span class="line">        read: ,</span><br><span class="line">        createdTime: ,</span><br><span class="line">        modifiedTime: ,</span><br><span class="line">        author: ,</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>下面我们看下如何对它进行 <code>增删改查</code> 的操作。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// add</span></span><br><span class="line"></span><br><span class="line">articles = <span class="built_in">Object</span>.assign(&#123;&#125;, articles, &#123;</span><br><span class="line">    [id]: &#123;</span><br><span class="line">        id: ,</span><br><span class="line">        read: ,</span><br><span class="line">        createdTime: ,</span><br><span class="line">        modifiedTime: ,</span><br><span class="line">        author: ,</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// delete</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> articles[id]</span><br><span class="line"></span><br><span class="line"><span class="comment">// update</span></span><br><span class="line"></span><br><span class="line">articles = <span class="built_in">Object</span>.assign(</span><br><span class="line">    &#123;&#125;,</span><br><span class="line">    &#123;articles&#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        [id]: &#123;</span><br><span class="line">            ...articles[id],</span><br><span class="line">            xxx: <span class="string">'xx'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// get</span></span><br><span class="line"></span><br><span class="line">articles[id]</span><br></pre></td></tr></table></figure>
<p><code>what ?</code> 对，你没有看错，一次遍历都没有！一次遍历都没有！一次遍历都没有！<br>而且我们在 <code>改删</code> 时候的操作是不是非常的简洁？关于更多类似于这种数据结构的设计你可以<a href="https://github.com/paularmstrong/normalizr">点击这里</a>。</p>
<h3 id="为什么现在才流行起来？"><a href="#为什么现在才流行起来？" class="headerlink" title="为什么现在才流行起来？"></a>为什么现在才流行起来？</h3><p>并不是说以前的人太笨了，而是在 <code>ES6</code> 普及之后，这种数据格式才真正开始兴起。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ES6 常用 Object 操作</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 返回对象的键的数组</span></span><br><span class="line"><span class="built_in">Object</span>.keys(); </span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 返回对象的值的数据</span></span><br><span class="line"><span class="built_in">Object</span>.values();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 合并多个对象并返回</span></span><br><span class="line"><span class="built_in">Object</span>.assign();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 返回对象的键值对的二维数组</span></span><br><span class="line"><span class="built_in">Object</span>.entries();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ES6 常用 Array 操作</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 目标值是否是一个数组</span></span><br><span class="line"><span class="built_in">Array</span>.isArray();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 过滤数组</span></span><br><span class="line"><span class="built_in">Array</span>.filter();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 遍历数组</span></span><br><span class="line"><span class="built_in">Array</span>.map();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. 缩减数组</span></span><br><span class="line"><span class="built_in">Array</span>.reduce();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. 缩减数组，从右到左。</span></span><br><span class="line"><span class="built_in">Array</span>.reduceRight();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 6. 遍历数组，找到符合的元素并返回</span></span><br><span class="line"><span class="built_in">Array</span>.find();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 7. 遍历数组，找到符合的元素并返回其索引</span></span><br><span class="line"><span class="built_in">Array</span>.findIndex();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 8. 排序数组</span></span><br><span class="line"><span class="built_in">Array</span>.sort();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 9. 数组是否包含某个元素</span></span><br><span class="line"><span class="built_in">Array</span>.includes();</span><br></pre></td></tr></table></figure>
<p>上面这些是工作中可能会频繁用到的，关于数组或对象的更多更多用法可以自行参阅<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array" target="_blank" rel="noopener">MDN-Array</a>和<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object" target="_blank" rel="noopener">MDN-Object</a>。</p>
</div></article></div></main><footer><div class="paginator"><a href="/blog/2018/07/27/初探Canvas/" class="prev">PREV</a><a href="/blog/2017/10/20/React-16-0-0/" class="next">NEXT</a></div><div class="copyright"><p>© 2016 - 2018 <a href="https://github.com/TheNightElf">冷暖我自知</a></p></div></footer></div></body></html>